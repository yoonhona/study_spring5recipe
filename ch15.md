## 15-6 스프링 인티그레이션을 이용해 에러 처리하기

#### 과제

- 스프링 인티그레이션은 상이한 노드, 컴퓨터, 서비스, 프로토콜, 언어 스택 등으로 흩어진 시스템을 서로 연결합니다.
- 비동기로 움직이는 컴포넌트에서 발생한 예외를 처리하는 것은 싱글 스레드로 처리하는 try/catch 블록처럼 그리 간단한 문제가 아닙니다. 
- 따라서 어떤 종류의 채널과 큐를 사용해 솔루션을 구축하든지 에러를 일으킨 컴포넌트에 대해 자연스럽게 에러를 분산시켜 통지할 방법이 필요합니다.
- 따라서 에러는 JMS 큐를 거쳐 다른 스레드의 프로세스나 큐로 전송할 수 있어야 합니다.

#### 해결책

- 스프링 인티그레이션은 직/간접적인 코드를 사용해 에러 채널을 지원합니다.

#### 풀이

- 예외를 붙잡아 에러 채널로 보낼 수 있습니다.
- errorChannel 전역 에러 채널을 사용
- 해당 채널에서 LoggingHandler라는 핸들러를 등록해 예외 및 스택드레이스를 로깅

```diff
@Bean
public IntegrationFlow jmsInbound(ConnectionFactory connectionFactory) {
    return IntegrationFlows
+  .from(Jms.messageDrivenChannelAdapter(connectionFactory).extractPayload(true).destination("recipe-15-6").errorChannel("errorChannel"))
            .transform(customerTransformer())
            .handle(customerServiceActivator())
            .get();
}
```

